<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Redis的其他功能 | Jiavg</title><meta name="description" content="Redis的其他功能"><meta name="keywords" content="Redis"><meta name="author" content="Jiavg"><meta name="copyright" content="Jiavg"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Redis的其他功能"><meta name="twitter:description" content="Redis的其他功能"><meta name="twitter:image" content="https://jiavag.github.io/img/bg/7.png"><meta property="og:type" content="article"><meta property="og:title" content="Redis的其他功能"><meta property="og:url" content="https://jiavag.github.io/2020/04/17/Redis/%E7%AC%AC4%E7%AB%A0-Redis%E7%9A%84%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD/"><meta property="og:site_name" content="Jiavg"><meta property="og:description" content="Redis的其他功能"><meta property="og:image" content="https://jiavag.github.io/img/bg/7.png"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://jiavag.github.io/2020/04/17/Redis/%E7%AC%AC4%E7%AB%A0-Redis%E7%9A%84%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD/"><link rel="prev" title="EXPLAIN用法和结果分析" href="https://jiavag.github.io/2020/04/18/SQL/2.SQL-%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%88%99/"><link rel="next" title="EXPLAIN用法和结果分析" href="https://jiavag.github.io/2020/04/17/SQL/1.SQL-EXPLAIN%E7%94%A8%E6%B3%95%E5%92%8C%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90/"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: 'ca-pub-6386517046719934',
  enable_page_level_ads: 'true'
});</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://www.lylgjiavg.github.io","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"languages":{"author":"作者: Jiavg","link":"链接: ","source":"来源: Jiavg","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'true',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">37</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">28</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">8</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#瑞士军刀Redis"><span class="toc-number">1.</span> <span class="toc-text">瑞士军刀Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#慢查询"><span class="toc-number">1.1.</span> <span class="toc-text">慢查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#声明周期"><span class="toc-number">1.1.1.</span> <span class="toc-text">声明周期</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#两个配置"><span class="toc-number">1.1.2.</span> <span class="toc-text">两个配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#配置方法"><span class="toc-number">1.1.3.</span> <span class="toc-text">配置方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#默认值"><span class="toc-number">1.1.3.1.</span> <span class="toc-text">默认值</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#慢查询命令"><span class="toc-number">1.1.4.</span> <span class="toc-text">慢查询命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#运维经验"><span class="toc-number">1.1.5.</span> <span class="toc-text">运维经验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pipeline"><span class="toc-number">1.2.</span> <span class="toc-text">Pipeline</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1次网络命令通信模型"><span class="toc-number">1.2.1.</span> <span class="toc-text">1次网络命令通信模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#批量网络命令通信模型"><span class="toc-number">1.2.2.</span> <span class="toc-text">批量网络命令通信模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#什么是流水线"><span class="toc-number">1.2.3.</span> <span class="toc-text">什么是流水线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#流水线的作用"><span class="toc-number">1.2.4.</span> <span class="toc-text">流水线的作用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pipeline-Jedis实现"><span class="toc-number">1.2.5.</span> <span class="toc-text">Pipeline - Jedis实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#没有pipeline"><span class="toc-number">1.2.5.1.</span> <span class="toc-text">没有pipeline</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#使用pipeline"><span class="toc-number">1.2.5.2.</span> <span class="toc-text">使用pipeline</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pipeline与原生M操作"><span class="toc-number">1.2.6.</span> <span class="toc-text">Pipeline与原生M操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#原生M操作"><span class="toc-number">1.2.6.1.</span> <span class="toc-text">原生M操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Pipeline-1"><span class="toc-number">1.2.6.2.</span> <span class="toc-text">Pipeline</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Pipeline使用建议"><span class="toc-number">1.2.7.</span> <span class="toc-text">Pipeline使用建议</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#发布订阅"><span class="toc-number">1.3.</span> <span class="toc-text">发布订阅</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#角色"><span class="toc-number">1.3.1.</span> <span class="toc-text">角色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模型"><span class="toc-number">1.3.2.</span> <span class="toc-text">模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API"><span class="toc-number">1.3.3.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#publish-发布命令"><span class="toc-number">1.3.3.1.</span> <span class="toc-text">publish (发布命令)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#subscribe-订阅"><span class="toc-number">1.3.3.2.</span> <span class="toc-text">subscribe (订阅)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#unsubscribe-取消订阅"><span class="toc-number">1.3.3.3.</span> <span class="toc-text">unsubscribe (取消订阅)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#其他API"><span class="toc-number">1.3.3.4.</span> <span class="toc-text">其他API</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#消息队列和发布订阅"><span class="toc-number">1.3.4.</span> <span class="toc-text">消息队列和发布订阅</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Bitmap"><span class="toc-number">1.4.</span> <span class="toc-text">Bitmap</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#位图"><span class="toc-number">1.4.1.</span> <span class="toc-text">位图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API-1"><span class="toc-number">1.4.2.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#setbit"><span class="toc-number">1.4.2.1.</span> <span class="toc-text">setbit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getbit"><span class="toc-number">1.4.2.2.</span> <span class="toc-text">getbit</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bitcount"><span class="toc-number">1.4.2.3.</span> <span class="toc-text">bitcount</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bitop"><span class="toc-number">1.4.2.4.</span> <span class="toc-text">bitop</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#bitpos"><span class="toc-number">1.4.2.5.</span> <span class="toc-text">bitpos</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#独立用户统计"><span class="toc-number">1.4.3.</span> <span class="toc-text">独立用户统计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#set和Bitmap对比"><span class="toc-number">1.4.3.1.</span> <span class="toc-text">set和Bitmap对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用经验"><span class="toc-number">1.4.4.</span> <span class="toc-text">使用经验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HyperLogLog"><span class="toc-number">1.5.</span> <span class="toc-text">HyperLogLog</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#三个命令"><span class="toc-number">1.5.1.</span> <span class="toc-text">三个命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#演示"><span class="toc-number">1.5.2.</span> <span class="toc-text">演示</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#内存消耗-百万独立用户"><span class="toc-number">1.5.2.1.</span> <span class="toc-text">内存消耗 (百万独立用户)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#使用经验-1"><span class="toc-number">1.5.3.</span> <span class="toc-text">使用经验</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GEO"><span class="toc-number">1.6.</span> <span class="toc-text">GEO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#应用场景"><span class="toc-number">1.6.1.</span> <span class="toc-text">应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5个城市经纬度"><span class="toc-number">1.6.2.</span> <span class="toc-text">5个城市经纬度</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#API-2"><span class="toc-number">1.6.3.</span> <span class="toc-text">API</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#geoadd"><span class="toc-number">1.6.3.1.</span> <span class="toc-text">geoadd</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#geopos"><span class="toc-number">1.6.3.2.</span> <span class="toc-text">geopos</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#geodist"><span class="toc-number">1.6.3.3.</span> <span class="toc-text">geodist</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#georadius"><span class="toc-number">1.6.3.4.</span> <span class="toc-text">georadius</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#相关说明"><span class="toc-number">1.6.4.</span> <span class="toc-text">相关说明</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(/img/bg/7.png)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Jiavg</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 关于</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 清单</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> 音乐</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> 电影</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">Redis的其他功能</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="发表于 2020-04-17 04:27:43"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-04-17</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="更新于 2020-04-18 04:42:27"><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-04-18</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Redis/">Redis</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="瑞士军刀Redis"><a href="#瑞士军刀Redis" class="headerlink" title="瑞士军刀Redis"></a>瑞士军刀Redis</h1><ul>
<li>慢查询</li>
<li>pipeline</li>
<li>发布订阅</li>
<li>Bitmap</li>
<li>HyperLogLog</li>
<li>GEO</li>
</ul>
<h2 id="慢查询"><a href="#慢查询" class="headerlink" title="慢查询"></a>慢查询</h2><h3 id="声明周期"><a href="#声明周期" class="headerlink" title="声明周期"></a>声明周期</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/17/XIBxmqeO3PA4vnw.jpg"  alt="2020-04-17_043252"></p>
<ul>
<li>慢查询发生在第三阶段 (执行命令), 其中发送命令和排队导致的响应时延问题并不属于慢查询, 而是由于执行(keys, flushall, flushdb, slow lua script, mutil/exec, operate big value (collection))这些重量级的命令导致的问题.</li>
<li>客户端超时不一定是慢查询, 但慢查询是客户端超时的一个可能因素.</li>
<li>我们可以使用 slowlog(慢查询)功能找出最耗时的 Redis 命令进行相关的优化，以提升 Redis 的运行速度，慢查询有两个重要的配置项.</li>
</ul>
<h3 id="两个配置"><a href="#两个配置" class="headerlink" title="两个配置"></a>两个配置</h3><ul>
<li><p>slowlog-max-len</p>
<ul>
<li>表示慢查询日志的条数</li>
<li>慢查询队列是一个先进先出队列, 当队列超过长度将会剔除最先入队的慢查询信息</li>
<li>慢查询队列是一个固定长度的队列(可通过配置文件或者命令修改此长度)</li>
<li>慢查询队列保存在内存中, 将随着内存的</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/17/CJrkKpxqjZ2I9li.jpg"  alt="2020-04-17_045300"></p>
</li>
<li><p>slowlog-log-slower-than</p>
<ul>
<li>慢查询阈值 (单位: 微秒), 执行超过这个时间的命令将被记录到慢查询日志</li>
<li>slowlog-log-slower-than = 0, 记录所有命令</li>
<li>slowlog-log-slower-than &lt; 0, 不记录任何命令</li>
</ul>
</li>
</ul>
<h3 id="配置方法"><a href="#配置方法" class="headerlink" title="配置方法"></a>配置方法</h3><h4 id="默认值"><a href="#默认值" class="headerlink" title="默认值"></a>默认值</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; config get slowlog-max-len</span><br><span class="line">1) "slowlog-max-len"</span><br><span class="line">2) "128"</span><br><span class="line">127.0.0.1:6379&gt; config get slowlog-log-slower-than</span><br><span class="line">1) "slowlog-log-slower-than"</span><br><span class="line">2) "10000"</span><br></pre></td></tr></table></figure>

<ul>
<li><p>修改配置文件重启</p>
<ul>
<li>不推荐, 当首次运行时可以使用此操作, 运行时是支持动态配置的</li>
</ul>
</li>
<li><p>动态配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; config set slowlog-max-len 1000</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; config set slowlog-log-slower-than 1000</span><br><span class="line">OK</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="慢查询命令"><a href="#慢查询命令" class="headerlink" title="慢查询命令"></a>慢查询命令</h3><ul>
<li>slowlog get [n] : 获取慢查询队列</li>
<li>slowlog len : 获取慢查询队列长度</li>
<li>slowlog reset : 清空慢查询队列</li>
</ul>
<h3 id="运维经验"><a href="#运维经验" class="headerlink" title="运维经验"></a>运维经验</h3><ul>
<li><p>slowlog-log-slower-than 不要设置过大, 默认10ms, 通常设置1ms, 通过QPS来确定此参数</p>
</li>
<li><p>slowlog-max-len 不要设置过小 (设置过小不利于慢查询日志分析), 通常设置1000左右</p>
</li>
<li><p>理解命令声明周期</p>
</li>
<li><p>定期持久化慢查询, 因为慢查询记录在内存中(队列长度和内存重启都可能导致慢查询日志丢失), 可以利用slowlog get命令来持久化到硬盘上</p>
</li>
</ul>
<h2 id="Pipeline"><a href="#Pipeline" class="headerlink" title="Pipeline"></a>Pipeline</h2><h3 id="1次网络命令通信模型"><a href="#1次网络命令通信模型" class="headerlink" title="1次网络命令通信模型"></a>1次网络命令通信模型</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/HioAtTBdGkubzn9.jpg"  alt="2020-04-18_015638"></p>
<h3 id="批量网络命令通信模型"><a href="#批量网络命令通信模型" class="headerlink" title="批量网络命令通信模型"></a>批量网络命令通信模型</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/JByzSMrWwbEoH5d.jpg"  alt="2020-04-18_015744"></p>
<h3 id="什么是流水线"><a href="#什么是流水线" class="headerlink" title="什么是流水线"></a>什么是流水线</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/QbWAVv5hR34TotY.jpg"  alt="2020-04-18_015833"></p>
<h3 id="流水线的作用"><a href="#流水线的作用" class="headerlink" title="流水线的作用"></a>流水线的作用</h3><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/AqZc3nDMQf6v9wY.jpg"  alt="2020-04-18_015927"  />

<p>注意:</p>
<ul>
<li>Redis的命令时间是微秒级别. (网络命令传输是Redis执行效果的瓶颈之一)</li>
<li>Pipeline每次条数要控制 (网络).</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/pGi82tyRWj6FuVr.jpg"  alt="2020-04-18_020211"></p>
<h3 id="Pipeline-Jedis实现"><a href="#Pipeline-Jedis实现" class="headerlink" title="Pipeline - Jedis实现"></a>Pipeline - Jedis实现</h3><ul>
<li>执行10000条命令时:</li>
</ul>
<h4 id="没有pipeline"><a href="#没有pipeline" class="headerlink" title="没有pipeline"></a>没有pipeline</h4><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/1F3KsXQRDTkern6.jpg"  alt="2020-04-18_020336"></p>
<h4 id="使用pipeline"><a href="#使用pipeline" class="headerlink" title="使用pipeline"></a>使用pipeline</h4><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/rsK6QgZ1h53JCku.jpg"  alt="2020-04-18_020437"></p>
<h3 id="Pipeline与原生M操作"><a href="#Pipeline与原生M操作" class="headerlink" title="Pipeline与原生M操作"></a>Pipeline与原生M操作</h3><h4 id="原生M操作"><a href="#原生M操作" class="headerlink" title="原生M操作"></a>原生M操作</h4><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/HZCt9FuKNnP4hTO.jpg"  alt="2020-04-18_020539"></p>
<h4 id="Pipeline-1"><a href="#Pipeline-1" class="headerlink" title="Pipeline"></a>Pipeline</h4><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/iFvyL2u9sokxdt8.jpg"  alt="2020-04-18_020635"></p>
<h3 id="Pipeline使用建议"><a href="#Pipeline使用建议" class="headerlink" title="Pipeline使用建议"></a>Pipeline使用建议</h3><ul>
<li>注意每次pipeline携带数据量</li>
<li>pipeline每次只能作用在一个Redis节点上</li>
<li>M操作与pipeline区别</li>
</ul>
<h2 id="发布订阅"><a href="#发布订阅" class="headerlink" title="发布订阅"></a>发布订阅</h2><h3 id="角色"><a href="#角色" class="headerlink" title="角色"></a>角色</h3><ul>
<li>发布者 (publisher)</li>
<li>订阅者 (subscriber)</li>
<li>频道 (channel)</li>
</ul>
<h3 id="模型"><a href="#模型" class="headerlink" title="模型"></a>模型</h3><ul>
<li>发布者和订阅者都是一个redis客户端</li>
<li>发布者发送一个消息, 订阅该频道的订阅者都可以接受到此消息</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/2qaz7nFxgrikbBt.jpg"  alt="2020-04-18_030643"></p>
<ul>
<li>一个订阅者可以同时订阅多个频道</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/nTZKld9DSIXWC4o.jpg"  alt="2020-04-18_031044"></p>
<h3 id="API"><a href="#API" class="headerlink" title="API"></a>API</h3><ul>
<li>publish</li>
<li>unsubscribe</li>
<li>subscribe</li>
<li>其他</li>
</ul>
<h4 id="publish-发布命令"><a href="#publish-发布命令" class="headerlink" title="publish (发布命令)"></a>publish (发布命令)</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">publish channel message</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; publish sohu:tv "helloworld"</span><br><span class="line">(integer) 2</span><br></pre></td></tr></table></figure>

<h4 id="subscribe-订阅"><a href="#subscribe-订阅" class="headerlink" title="subscribe (订阅)"></a>subscribe (订阅)</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subscribe [channel] # 一个或多个</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; subscribe sohu:tv</span><br><span class="line">Reading messages... (press Ctrl-C to quit)</span><br><span class="line">1) &quot;subscribe&quot;</span><br><span class="line">2) &quot;sohu:tv&quot;</span><br><span class="line">3) (integer) 1</span><br><span class="line">1) &quot;message&quot;</span><br><span class="line">2) &quot;sohu:tv&quot;</span><br><span class="line">3) &quot;helloworld&quot;</span><br></pre></td></tr></table></figure>

<h4 id="unsubscribe-取消订阅"><a href="#unsubscribe-取消订阅" class="headerlink" title="unsubscribe (取消订阅)"></a>unsubscribe (取消订阅)</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">unsubscribe [channel] # 一个或多个</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; unsubscribe souhu:tv</span><br><span class="line">1) "unsubscribe"</span><br><span class="line">2) "souhu:tv"</span><br><span class="line">3) (integer) 0</span><br></pre></td></tr></table></figure>

<h4 id="其他API"><a href="#其他API" class="headerlink" title="其他API"></a>其他API</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">psubscribe [pattern...] # 订阅模式</span><br><span class="line">punsubscribe [pattern...] # 取消指定的订阅模式</span><br><span class="line">pubsub channels # 列出至少有一个订阅者的频道</span><br><span class="line">pubsub numsub [channel...] # 列出给定频道的订阅者数量</span><br></pre></td></tr></table></figure>

<h3 id="消息队列和发布订阅"><a href="#消息队列和发布订阅" class="headerlink" title="消息队列和发布订阅"></a>消息队列和发布订阅</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/6cCUu8NwBdMzvEt.jpg"  alt="2020-04-18_032854"></p>
<h2 id="Bitmap"><a href="#Bitmap" class="headerlink" title="Bitmap"></a>Bitmap</h2><h3 id="位图"><a href="#位图" class="headerlink" title="位图"></a>位图</h3><ul>
<li>Redis可以对存储的数据进行对位操作</li>
<li>示例:</li>
</ul>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; set hello big</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; getbit hello 0</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; getbit hello 1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; getbit hello 2</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; getbit hello 3</span><br><span class="line">(integer) 0</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/Ofl1IXnNFBTLoAU.jpg"  alt="2020-04-18_033106"></p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/SWtfyPMeKmh4LVJ.jpg"  alt="2020-04-18_033636"></p>
<h3 id="API-1"><a href="#API-1" class="headerlink" title="API"></a>API</h3><h4 id="setbit"><a href="#setbit" class="headerlink" title="setbit"></a>setbit</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 给位图指定索引设置值</span></span><br><span class="line">setbit key offset value</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/ZwP2fVjFkM9UCo3.jpg"  alt="2020-04-18_033914"></p>
<p>效果:</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/IolCNcxnjfHhLGV.jpg"  alt="2020-04-18_034115"></p>
<ul>
<li>可以做一些独立用户统计的功能</li>
<li>如果只设置索引50, 则位图变为:<ul>
<li>注意: 一般不要在一个很短的位图上突然间做一个很大的偏移量, 会引起一些问题 (注意Redis是一个单线程)</li>
</ul>
</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/w8PEhLjTBaiYy3H.jpg"  alt="2020-04-18_034433"></p>
<h4 id="getbit"><a href="#getbit" class="headerlink" title="getbit"></a>getbit</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取位图指定索引的值</span></span><br><span class="line">getbit key offset</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/lpTokyVeW5gqfHa.jpg"  alt="2020-04-18_034748"></p>
<h4 id="bitcount"><a href="#bitcount" class="headerlink" title="bitcount"></a>bitcount</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取位图指定范围(start到end, 单位为字节, 如果不能指定就是获取全部)位值为1的个数</span></span><br><span class="line">bitcount key [start end]</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/k7tqY5Kz1doThiQ.jpg"  alt="2020-04-18_035325"></p>
<h4 id="bitop"><a href="#bitop" class="headerlink" title="bitop"></a>bitop</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 做多个Bitmap的and(交集), or(并集), not(非), xor(异或)操作并将结果保存在destkey中</span></span><br><span class="line">bitop op destkey key [key...]</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/OljKox8sIVGR4yd.jpg"  alt="2020-04-18_035705"></p>
<h4 id="bitpos"><a href="#bitpos" class="headerlink" title="bitpos"></a>bitpos</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 计算位图指定范围(start到end, 单位为字节, 如果不能指定就是获取全部)第一个便宜量对应的值等于targetBit的位置</span></span><br><span class="line">bitpos key targetBit [start] [end]</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; setbit bitops_key 2 1</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; setbit bitops_key 4 1</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; bitcount bitops_key  0 1</span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; bitpos bitops_key 1 </span><br><span class="line">(integer) 2</span><br><span class="line">127.0.0.1:6379&gt; bitpos bitops_key 1 3</span><br><span class="line">(integer) -1</span><br></pre></td></tr></table></figure>

<h3 id="独立用户统计"><a href="#独立用户统计" class="headerlink" title="独立用户统计"></a>独立用户统计</h3><ul>
<li>1亿用户, 5千万独立</li>
</ul>
<h4 id="set和Bitmap对比"><a href="#set和Bitmap对比" class="headerlink" title="set和Bitmap对比"></a>set和Bitmap对比</h4><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/jKMkF2Lz1eHycuY.jpg"  alt="2020-04-18_040613"></p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/SrkwubKc3GpoHOQ.jpg"  alt="2020-04-18_040656"></p>
<ul>
<li>只有10万独立用户</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/ESW7rc34gmTVIzC.jpg"  alt="2020-04-18_040804"></p>
<h3 id="使用经验"><a href="#使用经验" class="headerlink" title="使用经验"></a>使用经验</h3><ul>
<li>Bitmap的 type = string, 且最大支持512MB</li>
<li>注意setbit时的偏移量, 可能有较大消耗</li>
<li>位图不是绝对的好, 要根据合理的场景进行使用</li>
</ul>
<h2 id="HyperLogLog"><a href="#HyperLogLog" class="headerlink" title="HyperLogLog"></a>HyperLogLog</h2><ul>
<li><p>基于HyperLogLog算法: 极小的空间完成独立数量统计</p>
</li>
<li><p>在Redis中本质还是字符串</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/6aGvYZhRWjs1iNd.jpg"  alt="2020-04-18_041943"></p>
</li>
</ul>
<h3 id="三个命令"><a href="#三个命令" class="headerlink" title="三个命令"></a>三个命令</h3><ul>
<li>pfadd key element [element…]   # 向HyperLogLog添加元素</li>
<li>pfcount key [key…]   # 计算HyperLogLog的独立总数</li>
<li>pfmerge destkey sourcekey [sourcekey…]   # 合并多个HyperLogLog</li>
</ul>
<h3 id="演示"><a href="#演示" class="headerlink" title="演示"></a>演示</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/tK4Fc1gfIAOpyJx.jpg"  alt="2020-04-18_042239"></p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/T7iQj2eWrKkbsfv.jpg"  alt="2020-04-18_042317"></p>
<h4 id="内存消耗-百万独立用户"><a href="#内存消耗-百万独立用户" class="headerlink" title="内存消耗 (百万独立用户)"></a>内存消耗 (百万独立用户)</h4><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/JukORi3UNrgVo1f.jpg"  alt="2020-04-18_042422"></p>
<h3 id="使用经验-1"><a href="#使用经验-1" class="headerlink" title="使用经验"></a>使用经验</h3><ul>
<li><p>是否能够容忍错误? (错误率: 0.81%)</p>
<ul>
<li>例如上述百万条数据做如下操作:</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/pvj3SVe2t9mlnTw.jpg"  alt="2020-04-18_042632"></p>
</li>
<li><p>是否需要单条数据? </p>
<ul>
<li>HyperLogLog不能够获取单条数据</li>
</ul>
</li>
</ul>
<h2 id="GEO"><a href="#GEO" class="headerlink" title="GEO"></a>GEO</h2><ul>
<li>GEO (地理位置信息定位): 存储经纬度, 计算两地距离, 范围计算等</li>
</ul>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/7GJmOIM3ARSgKe6.jpg"  alt="2020-04-18_042908"></p>
<h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/YRVZfI7b8H43Fwh.jpg"  alt="2020-04-18_042958"></p>
<h3 id="5个城市经纬度"><a href="#5个城市经纬度" class="headerlink" title="5个城市经纬度"></a>5个城市经纬度</h3><p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/KzCcmPSoIduksOn.jpg"  alt="2020-04-18_043047"></p>
<h3 id="API-2"><a href="#API-2" class="headerlink" title="API"></a>API</h3><h4 id="geoadd"><a href="#geoadd" class="headerlink" title="geoadd"></a>geoadd</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 增加地理位置信息</span></span><br><span class="line">geo key longitude latitude member [longitude latitude member...]</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/6MI5dQ3Ap2HY8uC.jpg"  alt="2020-04-18_043309" style="zoom:50%;" />

<h4 id="geopos"><a href="#geopos" class="headerlink" title="geopos"></a>geopos</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取地理位置信息</span></span><br><span class="line">geopos key member [member...]</span><br></pre></td></tr></table></figure>

<p>演示:</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/zSr1yMhUOWgPlkQ.jpg"  alt="2020-04-18_043514"></p>
<h4 id="geodist"><a href="#geodist" class="headerlink" title="geodist"></a>geodist</h4><p>API:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 获取两个地理位置的距离</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> unit: m(米), km(千米), mi(英里), ft(尺)</span></span><br><span class="line">geodist key member1 member2 [unit]</span><br></pre></td></tr></table></figure>

<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/J6szxMDiTqWv9mc.jpg"  alt="2020-04-18_043816"></p>
<h4 id="georadius"><a href="#georadius" class="headerlink" title="georadius"></a>georadius</h4><p>API:</p>
<p><img src="/" class="lazyload" data-src="https://i.loli.net/2020/04/18/oULtQCVunZ6JSsb.jpg"  alt="2020-04-18_043910"></p>
<p>示例:</p>
<p><img src="/" class="lazyload" data-src="E:%5Cblog-static%5Cimage-new%5CRedis_4%5C2020-04-18_044020.jpg"  alt="2020-04-18_044020"></p>
<h3 id="相关说明"><a href="#相关说明" class="headerlink" title="相关说明"></a>相关说明</h3><ul>
<li>since 3.2 +</li>
<li>type geoKey = zset</li>
<li>没有删除API: 可以利用zset实现删除 zrem key member</li>
</ul>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Jiavg</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://jiavag.github.io/2020/04/17/Redis/%E7%AC%AC4%E7%AB%A0-Redis%E7%9A%84%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD/">https://jiavag.github.io/2020/04/17/Redis/%E7%AC%AC4%E7%AB%A0-Redis%E7%9A%84%E5%85%B6%E4%BB%96%E5%8A%9F%E8%83%BD/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://jiavag.github.io" target="_blank">Jiavg</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Redis/">Redis</a></div><div class="post_share"><div class="social-share" data-image="/img/bg/17.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.png" alt="支付寶"/><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/04/18/SQL/2.SQL-%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%88%99/"><img class="prev_cover lazyload" data-src="/img/bg/17.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">EXPLAIN用法和结果分析</div></div></a></div><div class="next-post pull_right"><a href="/2020/04/17/SQL/1.SQL-EXPLAIN%E7%94%A8%E6%B3%95%E5%92%8C%E7%BB%93%E6%9E%9C%E5%88%86%E6%9E%90/"><img class="next_cover lazyload" data-src="/img/bg/18.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">EXPLAIN用法和结果分析</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/04/14/Redis/第1章-Redis初识/" title="Redis初识"><img class="relatedPosts_cover lazyload"data-src="/img/post.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-14</div><div class="relatedPosts_title">Redis初识</div></div></a></div><div class="relatedPosts_item"><a href="/2020/04/14/Redis/第2章-Redis API的使用和理解/" title="Redis API的使用和理解"><img class="relatedPosts_cover lazyload"data-src="/img/bg/9.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-04-14</div><div class="relatedPosts_title">Redis API的使用和理解</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Jiavg</div><div class="framework-info"><span>驱动 </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>